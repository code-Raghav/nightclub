import Head from "next/head";
import { auth } from "../../firebaseConfig";
import { useAuthState } from "react-firebase-hooks/auth";
import { useForm } from "react-hook-form";
import { getAuth, updatePhoneNumber, updateProfile } from "firebase/auth";
import { Alert } from "next/app";
import { BsFillShieldLockFill, BsTelephoneFill } from "react-icons/bs";
import { CgSpinner } from "react-icons/cg";

export default function Profile() {
  const auth = getAuth();
  const [user, setUser] = useAuthState(auth);
  const { register, handleSubmit } = useForm();

  const updateName = (data) => {
    console.log(data);

    updateProfile(auth.currentUser, {
      displayName: data.name,
    })
      .then(() => {
        <Alert>Hi</Alert>;
      })
      .catch((error) => {
        // An error occurred
        // ...
      });
  };
  const updatePhone = (data) => {
    console.log(parseInt(data.phone));

    updateProfile(auth.currentUser, {
      displayName: data.name,
    })
      .then(() => {})
      .catch((error) => {
        // An error occurred
        // ...
      });
  };

  return (
    <>
      <Head>
        <title>Profile</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main>
        <div>
          <div>Name: {user ? user.displayName : ""}</div>
          <div>Email: {user ? user.email : ""}</div>
        </div>

        <form onSubmit={handleSubmit(updateName)}>
          <label htmlFor="name">Name</label>
          <input
            type="name"
            defaultValue={user ? user.displayName : ""}
            {...register("name", { required: true })}
          />

          <button>Submit</button>
        </form>
        <form onSubmit={handleSubmit(updatePhone)}>
          <label htmlFor="phone">Phone Number</label>
          <input
            type="phone"
            defaultValue={user && user.phoneNumber ? user.phoneNumber : ""}
            {...register("phone", { required: true })}
          />

          <button>Submit</button>
        </form>
        <div className="recaptcha-container"></div>
      </main>
    </>
  );
}
